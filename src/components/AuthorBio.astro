---
// src/components/AuthorBio.astro
import { Image } from 'astro:assets';
import type { ImageMetadata } from 'astro';
import { authorData } from '../data/authorData.js';

const authorImages = import.meta.glob('/src/assets/images/natalia/*.{jpeg,jpg,png,webp,svg}');
const imagePath = `/src/assets/${authorData.image}`;
const imageImport = authorImages[imagePath];

if (!imageImport) {
  throw new Error(`No se pudo encontrar la imagen del autor: ${imagePath}. Verifica la ruta en authorData.js.`);
}

// Agregar aserci√≥n de tipo para TypeScript
const resolvedImage = (await imageImport() as { default: ImageMetadata }).default;

const social = authorData.social ?? {};
const contact = authorData.contact ?? {};
---
<div class="author-bio">
  <Image 
    src={resolvedImage} 
    alt={`Foto de ${authorData.name}`} 
    quality={85}
    class="author-image"
  />
  <div class="author-details">
    <h3><span>Escrito por</span><br> {authorData.name}</h3>
    {authorData.title && <h4>{authorData.title}</h4>}
    <p>{authorData.bio}</p>

    <div class="author-icons">
      {contact.email && (
        <a href={`mailto:${contact.email}`} title="Email" aria-label="Email">
          <i class="ph ph-envelope-simple"></i>
        </a>
      )}
      {social.instagram && (
        <a href={social.instagram} target="_blank" rel="noopener" title="Instagram" aria-label="Instagram">
          <i class="ph ph-instagram-logo"></i>
        </a>
      )}
      {social.linkedin && (
        <a href={social.linkedin} target="_blank" rel="noopener" title="LinkedIn" aria-label="LinkedIn">
          <i class="ph ph-linkedin-logo"></i>
        </a>
      )}
    </div>
  </div>
</div>